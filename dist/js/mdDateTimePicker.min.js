!function(t,e){if("function"==typeof define&&define.amd)define(["exports","moment","draggabilly"],e);else if("undefined"!=typeof exports)e(exports,require("moment"),require("draggabilly"));else{var i={exports:{}};e(i.exports,t.moment,t.draggabilly),t.mdDateTimePicker=i.exports}}(this,function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var d=s(e),l=s(i),n=function(){function t(t,e){for(var i,s=0;s<e.length;s++)i=e[s],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=function(){function t(e){var i=e.type,s=e.init,l=void 0===s?(0,d.default)():s,n=e.past,o=void 0===n?(0,d.default)().subtract(21,"years"):n,c=e.future,r=void 0===c?l:c,_=e.mode,h=void 0!==_&&_,u=e.orientation,m=void 0===u?"LANDSCAPE":u,p=e.trigger,g=void 0===p?"":p,v=e.ok,f=void 0===v?"ok":v,D=e.cancel,y=void 0===D?"cancel":D,k=e.colon,C=void 0===k||k,L=e.autoClose,b=void 0!==L&&L,w=e.inner24,E=void 0!==w&&w,M=e.prevHandle,x=void 0===M?'<div class="mddtp-prev-handle"></div>':M,I=e.nextHandle,T=void 0===I?'<div class="mddtp-next-handle"></div>':I,N=e.excludeDays,V=void 0===N?[]:N,A=e.excludeDaysOfWeek,H=void 0===A?[]:A,Y=e.includeDays,B=void 0===Y?[]:Y;a(this,t),this._type=i,this._init=l,this._past=o,this._future=r,this._mode=h,this._orientation=m,this._trigger=g,this._ok=f,this._cancel=y,this._colon=C,this._autoClose=b,this._inner24=E,this._prevHandle=x,this._nextHandle=T,this._excludeDays=V,this._excludeDaysOfWeek=H,this._includeDays=B,this._sDialog={},this.displayClasses={show:"zoomIn",hide:"zoomOut"},"undefined"==typeof document||document.getElementById("mddtp-picker__"+this._type)||this._buildDialog()}return n(t,[{key:"hide",value:function(){this._selectDialog(),this._hideDialog()}},{key:"show",value:function(){this._selectDialog(),"date"===this._type?this._initDateDialog(this._init):"time"===this._type&&this._initTimeDialog(this._init),this._showDialog()}},{key:"isOpen",value:function(){return this._selectDialog(),!!t.dialog.state}},{key:"isClosed",value:function(){return this._selectDialog(),!t.dialog.state}},{key:"toggle",value:function(){if(this._selectDialog(),t.dialog.state)this.hide();else{if("date"===this._type){var e=this.time&&this.time.isValid();t.dialog.view=!1,this._switchToDateView(null,this),e||(this.time=(0,d.default)())}this.show()}}},{key:"_selectDialog",value:function(){this._sDialog.picker=document.getElementById("mddtp-picker__"+[this._type]);for(var t=["viewHolder","years","header","cancel","ok","left","right","previous","current","next","subtitle","title","titleDay","titleMonth","AM","PM","needle","hourView","minuteView","hour","minute","fakeNeedle","circularHolder","circle","dotSpan"],e=t.length;e--;)this._sDialog[t[e]]=document.getElementById("mddtp-"+this._type+"__"+t[e]);if(this._includeDays.length){var i=this._includeDays[0],s=this._includeDays[this._includeDays.length-1];this._sDialog.tDate=i.clone(),this._sDialog.sDate=i.clone(),this._past=i.clone(),this._future=s.clone()}else this._sDialog.tDate=this._init.clone(),this._sDialog.sDate=this._init.clone()}},{key:"_showDialog",value:function(){var e=this,i=this;t.dialog.state=!0,this._sDialog.picker.classList.remove("mddtp-picker--inactive"),this._sDialog.picker.classList.add(this.displayClasses.show),"PORTRAIT"===this._orientation&&this._sDialog.picker.classList.add("mddtp-picker--portrait"),setTimeout(function(){i._sDialog.picker.classList.remove(e.displayClasses.show)},300)}},{key:"_hideDialog",value:function(){var e=this,i=this,s=this._sDialog.years,a=i._sDialog.title,d=i._sDialog.subtitle,l=this._sDialog.viewHolder,n=this._sDialog.AM,o=this._sDialog.PM,c=this._sDialog.minute,r=this._sDialog.hour,_=this._sDialog.minuteView,h=this._sDialog.hourView,u=this._sDialog.picker,m=this._sDialog.needle,p=this._sDialog.dotSpan,g="mddtp-picker__color--active",v="mddtp-picker__circularView--hidden";t.dialog.state=!1,t.dialog.view=!0,this._sDialog.picker.classList.add(this.displayClasses.hide),"date"===this._type?(s.classList.remove(this.displayClasses.show,this.displayClasses.hide),s.classList.add("mddtp-picker__years--invisible"),a.classList.remove(g),d.classList.add(g),l.classList.remove(this.displayClasses.hide)):(n.classList.remove(g),o.classList.remove(g),c.classList.remove(g),r.classList.add(g),_.classList.add(v),h.classList.remove(v),d.style.display="none",p.style.display="none",m.className="mddtp-picker__selection"),setTimeout(function(){i._sDialog.picker.classList.remove("mddtp-picker--portrait"),i._sDialog.picker.classList.remove(e.displayClasses.hide),i._sDialog.picker.classList.add("mddtp-picker--inactive");var t=u.cloneNode(!0);u.parentNode.replaceChild(t,u)},300)}},{key:"_buildDialog",value:function(){var t=this._type,e=document.createDocumentFragment(),i=document.createElement("div"),s=document.createElement("div"),a=document.createElement("div"),l=document.createElement("div"),n=document.createElement("button"),o=document.createElement("button");if(i.id="mddtp-picker__"+t,i.classList.add("mddtp-picker"),i.classList.add("mddtp-picker-"+t),i.classList.add("mddtp-picker--inactive"),i.classList.add("animated"),this._addId(s,"header"),this._addClass(s,"header"),i.appendChild(s),this._addClass(a,"body"),a.appendChild(l),i.appendChild(a),"date"===this._type){var c=document.createElement("div"),r=document.createElement("div"),_=document.createElement("div"),h=document.createElement("div"),u=document.createElement("div"),m=document.createElement("ul"),p=document.createElement("li"),g=document.createElement("li"),v=document.createElement("li"),f=document.createElement("button"),D=document.createElement("button"),y=document.createElement("ul");this._addId(c,"subtitle"),this._addClass(c,"subtitle"),this._addId(r,"title"),this._addClass(r,"title",["mddtp-picker__color--active"]),this._addId(_,"titleDay"),this._addId(h,"titleMonth"),r.appendChild(_),r.appendChild(h),s.appendChild(c),s.appendChild(r),this._addId(u,"viewHolder"),this._addClass(u,"viewHolder",["animated"]),this._addClass(m,"views"),this._addId(p,"previous"),p.classList.add("mddtp-picker__view"),this._addId(g,"current"),g.classList.add("mddtp-picker__view"),this._addId(v,"next"),v.classList.add("mddtp-picker__view"),this._addView(p),this._addView(g),this._addView(v),u.appendChild(m),m.appendChild(p),m.appendChild(g),m.appendChild(v),this._addId(f,"left"),f.classList.add("mddtp-button"),this._addClass(f,"left"),f.setAttribute("type","button"),f.innerHTML=this._prevHandle,this._addId(D,"right"),D.classList.add("mddtp-button"),this._addClass(D,"right"),D.setAttribute("type","button"),D.innerHTML=this._nextHandle,this._addId(y,"years"),this._addClass(y,"years",["mddtp-picker__years--invisible","animated"]),a.appendChild(u),a.appendChild(f),a.appendChild(D),a.appendChild(y)}else{var k=document.createElement("div"),C=document.createElement("span"),L=document.createElement("span"),b=document.createElement("span"),w=document.createElement("div"),E=document.createElement("div"),M=document.createElement("div"),x=document.createElement("div"),I=document.createElement("div"),T=document.createElement("span"),N=document.createElement("span"),V=document.createElement("span"),A=document.createElement("div"),H=document.createElement("div"),Y=document.createElement("div");this._addId(k,"title"),this._addClass(k,"title"),this._addId(C,"hour"),C.classList.add("mddtp-picker__color--active"),L.textContent=":",this._addId(L,"dotSpan"),L.style.display="none",this._addId(b,"minute"),this._addId(w,"subtitle"),this._addClass(w,"subtitle"),w.style.display="none",this._addId(E,"AM"),E.textContent=(0,d.default)().localeData().meridiem(1,1,!0),this._addId(M,"PM"),M.textContent=(0,d.default)().localeData().meridiem(13,1,!0),k.appendChild(C),k.appendChild(L),k.appendChild(b),w.appendChild(E),w.appendChild(M),s.appendChild(k),s.appendChild(w),this._addId(x,"circularHolder"),this._addClass(x,"circularHolder"),this._addId(I,"needle"),I.classList.add("mddtp-picker__selection"),this._addClass(T,"dot"),this._addClass(N,"line"),this._addId(V,"circle"),this._addClass(V,"circle"),this._addId(A,"minuteView"),A.classList.add("mddtp-picker__circularView"),A.classList.add("mddtp-picker__circularView--hidden"),this._addId(H,"fakeNeedle"),H.classList.add("mddtp-picker__circle--fake"),this._addId(Y,"hourView"),Y.classList.add("mddtp-picker__circularView"),I.appendChild(T),I.appendChild(N),I.appendChild(V),x.appendChild(I),x.appendChild(A),x.appendChild(H),x.appendChild(Y),a.appendChild(x)}l.classList.add("mddtp-picker__action"),!0===this._autoClose&&(l.style.display="none"),this._addId(n,"cancel"),n.classList.add("mddtp-button"),n.setAttribute("type","button"),this._addId(o,"ok"),o.classList.add("mddtp-button"),o.setAttribute("type","button"),l.appendChild(n),l.appendChild(o),a.appendChild(l),e.appendChild(i),document.getElementsByTagName("body").item(0).appendChild(e)}},{key:"_initTimeDialog",value:function(t){var e=this._sDialog.hour,i=this._sDialog.minute,s=this._sDialog.subtitle,a=this._sDialog.dotSpan;if(this._mode){var d=parseInt(t.format("H"),10);0===d&&(d="00"),this._fillText(e,d),this._colon&&(a.style.display="initial")}else this._fillText(e,t.format("h")),t._locale.isPM(t.format("A"))?this._sDialog.PM.classList.add("mddtp-picker__color--active"):this._sDialog.AM.classList.add("mddtp-picker__color--active"),s.style.display="initial",a.style.display="initial";this._fillText(i,t.format("mm")),this._initHour(),this._initMinute(),this._attachEventHandlers(),this._changeM(),this._dragDial(),this._switchToView(e),this._switchToView(i),this._addClockEvent(),this._setButtonText()}},{key:"_initHour",value:function(){var t=this._sDialog.hourView,e=this._sDialog.needle,i="mddtp-hour__selected",s="mddtp-picker__cell--selected",a="mddtp-picker__cell--rotate-",d="mddtp-picker__cell",l=document.createDocumentFragment(),n=void 0;if(this._mode){var o=!0===this._inner24?10:5;n=parseInt(this._sDialog.tDate.format("H"),10);for(var c=1,r=o;c<=24;c++,r+=o){var _=document.createElement("div"),h=document.createElement("span");_.classList.add(d),h.textContent=24===c?"00":c;var u=r;!0===this._inner24&&c>12&&(u-=120,_.classList.add("mddtp-picker__cell--rotate24")),_.classList.add(a+u),n===c&&(_.id=i,_.classList.add(s),e.classList.add(a+u)),24===c&&0===n&&(_.id=i,_.classList.add(s),e.classList.add(a+u)),_.appendChild(h),l.appendChild(_)}}else{n=parseInt(this._sDialog.tDate.format("h"),10);for(var m=1,p=10;m<=12;m++,p+=10){var _=document.createElement("div"),h=document.createElement("span");_.classList.add(d),h.textContent=m,_.classList.add(a+p),n===m&&(_.id=i,_.classList.add(s),e.classList.add(a+p)),_.appendChild(h),l.appendChild(_)}}for(;t.lastChild;)t.removeChild(t.lastChild);t.appendChild(l)}},{key:"_initMinute",value:function(){for(var t=this._sDialog.minuteView,e=parseInt(this._sDialog.tDate.format("m"),10),i=document.createDocumentFragment(),s=5,a=10;s<=60;s+=5,a+=10){var d=document.createElement("div"),l=document.createElement("span");d.classList.add("mddtp-picker__cell"),l.textContent=60===s?this._numWithZero(0):this._numWithZero(s),0===e&&(e=60),d.classList.add("mddtp-picker__cell--rotate-"+a),(e===s||e-1===s||e+1===s||1===e&&60===s)&&(d.id="mddtp-minute__selected",d.classList.add("mddtp-picker__cell--selected")),d.appendChild(l),i.appendChild(d)}for(;t.lastChild;)t.removeChild(t.lastChild);t.appendChild(i)}},{key:"_initDateDialog",value:function(t){var e=this._sDialog.subtitle,i=(this._sDialog.title,this._sDialog.titleDay),s=this._sDialog.titleMonth;this._fillText(e,t.format("YYYY")),this._fillText(i,t.format("ddd, ")),this._fillText(s,t.format("MMM D")),this._initYear(),this._initViewHolder(),this._attachEventHandlers(),this._changeMonth(),this._setButtonText()}},{key:"_initViewHolder",value:function(){var t=this._sDialog.tDate,e=this._sDialog.current,i=this._sDialog.previous,s=this._sDialog.next,a=this._past,l=this._future;t.isBefore(a,"month")&&(t=a.clone()),t.isAfter(l,"month")&&(t=l.clone()),this._sDialog.tDate=t,this._includeDays.length?(this._initMonthIncludes(e,t),this._initMonthIncludes(s,(0,d.default)(this._getMonth(t,1))),this._initMonthIncludes(i,(0,d.default)(this._getMonth(t,-1)))):(this._initMonth(e,t),this._initMonth(s,(0,d.default)(this._getMonth(t,1))),this._initMonth(i,(0,d.default)(this._getMonth(t,-1)))),this._toMoveMonth()}},{key:"_initMonth",value:function(t,e){var i=e.format("MMMM YYYY"),s=t.getElementsByTagName("div");this._fillText(s[0],i);var a=document.createDocumentFragment(),l=s[3],n=d.default.weekdays(!0).indexOf(d.default.weekdays(!1,(0,d.default)(e).date(1).day())),o=-1,c=-1,r=parseInt((0,d.default)(e).endOf("month").format("D"),10)+n-1,_=n,h="mddtp-picker__cell",u=r,m=[];(0,d.default)().isSame(e,"month")&&(o=parseInt((0,d.default)().format("D"),10),o+=n-1);for(var p,g=0;g<this._excludeDays.length;g++)if(p=this._excludeDays[g],p.isSame(e,"month")){var v=parseInt(p.format("D"),10);v+=n-1,m.push(v)}this._past.isSame(e,"month")&&(_=parseInt(this._past.format("D"),10),_+=n-1),this._future.isSame(e,"month")&&(u=parseInt(this._future.format("D"),10),u+=n-1),this._sDialog.sDate.isSame(e,"month")&&(c=parseInt((0,d.default)(e).format("D"),10),c+=n-1);for(var f=0;f<42;f++){var D=document.createElement("span"),y=f-n+1;f>=n&&f<=r&&(f>u||f<_?D.classList.add(h+"--disabled"):m.includes(f)?D.classList.add(h+"--disabled"):this._excludeDaysOfWeek.includes(f%7)?(D.classList.add(h+"--disabled"),c===f&&c++):(D.classList.add(h),c===f&&(D.classList.add(h+"--selected"),D.id="mddtp-date__selected")),o===f&&D.classList.add(h+"--today"),this._fillText(D,y)),a.appendChild(D)}for(;l.lastChild;)l.removeChild(l.lastChild);l.appendChild(a),this._addCellClickEvent(l)}},{key:"_initMonthIncludes",value:function(t,e){var i=e.format("MMMM YYYY"),s=t.getElementsByTagName("div");this._fillText(s[0],i);var a=document.createDocumentFragment(),l=s[3],n=d.default.weekdays(!0).indexOf(d.default.weekdays(!1,(0,d.default)(e).date(1).day())),o=-1,c=-1,r=parseInt((0,d.default)(e).endOf("month").format("D"),10)+n-1,_="mddtp-picker__cell",h=[];(0,d.default)().isSame(e,"month")&&(o=parseInt((0,d.default)().format("D"),10),o+=n-1);for(var u=0;u<this._includeDays.length;u++){var m=this._includeDays[u];if(m.isSame(e,"month")){var p=parseInt(m.format("D"),10);p+=n-1,h.push(p)}}this._sDialog.sDate.isSame(e,"month")&&(c=parseInt((0,d.default)(e).format("D"),10),c+=n-1);for(var g=0;g<42;g++){var v=document.createElement("span"),f=g-n+1;g>=n&&g<=r&&(h.includes(g)?(v.classList.add(_),c===g&&(v.classList.add(_+"--selected"),v.id="mddtp-date__selected")):v.classList.add(_+"--disabled"),this._fillText(v,f)),o===g&&v.classList.add(_+"--today"),a.appendChild(v)}for(;l.lastChild;)l.removeChild(l.lastChild);l.appendChild(a),this._addCellClickEvent(l)}},{key:"_initYear",value:function(){for(var t=this._sDialog.years,e=this._sDialog.tDate.year(),i=document.createDocumentFragment(),s=Math.min(e,this._past.year()),a=Math.max(e,this._future.year()),d=s;d<=a;d++){var l=document.createElement("li");l.textContent=d,d===e&&(l.id="mddtp-date__currentYear",l.classList.add("mddtp-picker__li--current")),i.appendChild(l)}for(;t.lastChild;)t.removeChild(t.lastChild);t.appendChild(i),this._changeYear(t)}},{key:"_pointNeedle",value:function(e){var i=60,s=void 0,a=this._sDialog.circle,d=this._sDialog.fakeNeedle,l=this._sDialog.circularHolder,n=e._sDialog.needle;n.className="",n.classList.add("mddtp-picker__selection"),t.dialog.view?e._mode?(i=24,0===(s=parseInt(e._sDialog.sDate.format("H"),10))&&(s=24)):(i=12,s=e._sDialog.sDate.format("h")):(s=e._sDialog.sDate.format("m"),!0!==e._autoClose&&setTimeout(function(){var t=l.getBoundingClientRect(),e=a.getBoundingClientRect();d.style.left=e.left-t.left+"px",d.style.top=e.top-t.top+"px"},300));var o=parseInt(s,10),c=e._calcRotation(i,o);c&&(n.classList.add(c),!0===this._inner24&&24===i&&o>12&&n.classList.add("mddtp-picker__cell--rotate24"))}},{key:"_switchToView",value:function(t){var e=this;"date"===this._type?t.onclick=function(){e._switchToDateView(t,e)}:(!0===this._inner24&&e._mode&&(parseInt(e._sDialog.sDate.format("H"),10)>12?e._sDialog.needle.classList.add("mddtp-picker__cell--rotate24"):e._sDialog.needle.classList.remove("mddtp-picker__cell--rotate24")),t.onclick=function(){e._switchToTimeView(e)})}},{key:"_switchToTimeView",value:function(e){var i=e._sDialog.hourView,s=e._sDialog.minuteView,a=e._sDialog.hour,d=e._sDialog.minute,l="mddtp-picker__circularView--hidden";i.classList.toggle(l),s.classList.toggle(l),a.classList.toggle("mddtp-picker__color--active"),d.classList.toggle("mddtp-picker__color--active"),t.dialog.view=!t.dialog.view,e._pointNeedle(e)}},{key:"_switchToDateView",value:function(e,i){var s=this;e&&e.setAttribute("disabled","");var a=i._sDialog,d=a.years,l=a.viewHolder,n=a.title,o=a.subtitle,c=a.left,r=a.right,_=document.getElementById("mddtp-date__currentYear"),h=t.dialog.view;r.style.display=h?"none":"inherit",c.style.display=h?"none":"inherit",this.toggleElementClassName(d,this.displayClasses.show,h),this.toggleElementClassName(d,this.displayClasses.hide,!h),this.toggleElementClassName(l,this.displayClasses.show,!h),this.toggleElementClassName(l,this.displayClasses.hide,h),h&&(this.toggleElementClassName(d,"mddtp-picker__years--invisible",!1),"function"==typeof _.scrollIntoViewIfNeeded?_.scrollIntoViewIfNeeded():setTimeout(function(){s.toggleElementClassName(d,"mddtp-picker__years--invisible",!0)},200)),this.toggleElementClassName(n,"mddtp-picker__color--active",!h),this.toggleElementClassName(o,"mddtp-picker__color--active",h),t.dialog.view=!h,e&&setTimeout(function(){e.removeAttribute("disabled")},300)}},{key:"toggleElementClassName",value:function(t,e,i){i?t.classList.contains(e)||t.classList.add(e):t.classList.remove(e)}},{key:"_addClockEvent",value:function(){var t=this,e=this._sDialog.hourView,i=this._sDialog.minuteView,s="mddtp-picker__cell--selected";e.onclick=function(e){var i="mddtp-hour__selected",a=document.getElementById(i),d=0;e.target&&"SPAN"===e.target.nodeName&&(a.id="",a.classList.remove(s),e.target.parentNode.classList.add(s),e.target.parentNode.id=i,d=t._mode?parseInt(e.target.textContent,10):"AM"===t._sDialog.sDate.format("A")?e.target.textContent:parseInt(e.target.textContent,10)+12,t._sDialog.sDate.hour(d),t._sDialog.hour.textContent=e.target.textContent,t._pointNeedle(t),setTimeout(function(){t._switchToTimeView(t)},700))},i.onclick=function(e){var i="mddtp-minute__selected",a=document.getElementById(i),d=0;e.target&&"SPAN"===e.target.nodeName&&(a&&(a.id="",a.classList.remove(s)),e.target.parentNode.classList.add(s),e.target.parentNode.id=i,d=e.target.textContent,t._sDialog.sDate.minute(d),t._sDialog.minute.textContent=d,t._pointNeedle(t),!0===t._autoClose&&t._sDialog.ok.onclick())}}},{key:"_addCellClickEvent",value:function(t){var e=this;t.onclick=function(t){if(t.target&&"SPAN"===t.target.nodeName&&t.target.classList.contains("mddtp-picker__cell")){var i=t.target.textContent,s=e._sDialog.tDate.date(i),a="mddtp-date__selected",l="mddtp-picker__cell--selected",n=document.getElementById(a),o=e._sDialog.subtitle,c=e._sDialog.titleDay,r=e._sDialog.titleMonth;n&&(n.classList.remove(l),n.id=""),t.target.classList.add(l),t.target.id=a,e._sDialog.sDate=s.clone(),e._fillText(o,s.year()),e._fillText(c,s.format("ddd, ")),e._fillText(r,s.format("MMM D"));var _=new CustomEvent("dateChange",{bubbles:!0,detail:{selectedDate:(0,d.default)(s.toDate().getTime())}});e._sDialog.picker.dispatchEvent(_),!0===e._autoClose&&e._sDialog.ok.onclick()}}}},{key:"_toMoveMonth",value:function(){var t=this._sDialog.tDate,e=this._sDialog.left,i=this._sDialog.right,s=this._past,a=this._future;e.removeAttribute("disabled"),i.removeAttribute("disabled"),e.classList.remove("mddtp-button--disabled"),i.classList.remove("mddtp-button--disabled"),t.isSame(s,"month")&&(e.setAttribute("disabled",""),e.classList.add("mddtp-button--disabled")),t.isSame(a,"month")&&(i.setAttribute("disabled",""),i.classList.add("mddtp-button--disabled"));var l=new CustomEvent("monthChange",{bubbles:!0,detail:{selectedMonth:(0,d.default)(this._sDialog.tDate.toDate().getTime())}});this._sDialog.picker.dispatchEvent(l)}},{key:"_changeMonth",value:function(){function t(t,d){var l=!1,n=e._sDialog.next,o=e._sDialog.current,c=e._sDialog.previous;i.setAttribute("disabled",""),s.setAttribute("disabled",""),o.classList.add(t),c.classList.add(t),n.classList.add(t);var r=d.cloneNode(!0),_=void 0;d===n?(_=c,o.parentNode.appendChild(r),n.id=o.id,o.id=c.id,c=o,o=n,n=r):(l=!0,_=n,c.id=o.id,o.id=n.id,n=o,o=c),setTimeout(function(){d===c&&(o.parentNode.insertBefore(r,o),c=r),e._sDialog.next=n,e._sDialog.current=o,e._sDialog.previous=c,o.classList.add(a),n.classList.add(a),c.classList.add(a),o.classList.remove(t),n.classList.remove(t),c.classList.remove(t),_.parentNode.removeChild(_)},300),setTimeout(function(){o.classList.remove(a),n.classList.remove(a),c.classList.remove(a),e._sDialog.tDate=l?e._getMonth(e._sDialog.tDate,-1):e._getMonth(e._sDialog.tDate,1),e._initViewHolder(),i.classList.contains("mddtp-button--disabled")||i.removeAttribute("disabled"),s.classList.contains("mddtp-button--disabled")||s.removeAttribute("disabled")},350)}var e=this,i=this._sDialog.left,s=this._sDialog.right,a="mddtp-picker__view--pause";i.onclick=function(){t("mddtp-picker__view--right",e._sDialog.previous)},s.onclick=function(){t("mddtp-picker__view--left",e._sDialog.next)}}},{key:"_changeYear",value:function(t){var e=this;t.onclick=function(i){if(i.target&&"LI"===i.target.nodeName){var s=document.getElementById("mddtp-date__currentYear"),a=e._sDialog.subtitle,d=e._sDialog.titleDay,l=e._sDialog.titleMonth;s.id="",s.classList.remove("mddtp-picker__li--current"),i.target.id="mddtp-date__currentYear",i.target.classList.add("mddtp-picker__li--current"),e._switchToDateView(t,e),e._sDialog.tDate.year(parseInt(i.target.textContent,10)),e._sDialog.sDate=e._sDialog.tDate.clone(),e._fillText(a,e._sDialog.tDate.year()),e._fillText(d,e._sDialog.tDate.format("ddd, ")),e._fillText(l,e._sDialog.tDate.format("MMM D")),e._initViewHolder()}}}},{key:"_changeM",value:function(){var t=this,e=this._sDialog.AM,i=this._sDialog.PM;e.onclick=function(){var s="AM";t._sDialog.sDate._locale.isPM(t._sDialog.sDate.format("A"))&&(s="PM"),"PM"===s&&(t._sDialog.sDate.subtract(12,"h"),e.classList.toggle("mddtp-picker__color--active"),i.classList.toggle("mddtp-picker__color--active"))},i.onclick=function(){var s="AM";t._sDialog.sDate._locale.isPM(t._sDialog.sDate.format("A"))&&(s="PM"),"AM"===s&&(t._sDialog.sDate.add(12,"h"),e.classList.toggle("mddtp-picker__color--active"),i.classList.toggle("mddtp-picker__color--active"))}}},{key:"_dragDial",value:function(){var t=this,e=this._sDialog.needle,i=this._sDialog.circle,s=this._sDialog.fakeNeedle,a=this._sDialog.circularHolder,d=this._sDialog.minute,n="mddtp-picker__selection--quick",o="mddtp-picker__cell--selected",c=a.getBoundingClientRect(),r=void 0,_=new l.default(s,{containment:!0});_.on("pointerDown",function(){c=a.getBoundingClientRect()}),_.on("pointerMove",function(i){var s=i.clientX,a=i.clientY;if(void 0===s)if(void 0===i.pageX){if(!(i.touches&&i.touches.length>0))throw new Error("coult not detect pageX, pageY");s=i.touches[0].clientX,a=i.touches[0].clientY}else s=i.pageX-document.body.scrollLeft-document.documentElement.scrollLeft,a=i.pageY-document.body.scrollTop-document.documentElement.scrollTop;var l=s-c.left-c.width/2,o=a-c.top-c.height/2,_=Math.atan2(-o,l);e.className="",_<0&&(_+=2*Math.PI),_*=180/Math.PI,_=360-_,_>270&&(_-=360),r=parseInt(_/6);var h=Math.abs(6*r-_);Math.abs(6*(r+1)-_)<h&&r++,r+=15,e.classList.add("mddtp-picker__selection"),e.classList.add(n),e.classList.add("mddtp-picker__cell--rotate-"+2*r),d.textContent=t._numWithZero(r)});var h=function(){var a=t._sDialog.minuteView.getElementsByTagName("div"),l="mddtp-minute__selected",_=document.getElementById(l),h=i.getBoundingClientRect();s.style.left=h.left-c.left+"px",s.style.top=h.top-c.top+"px",e.classList.remove(n);var u=r;1===u&&(u=60),u=t._nearestDivisor(u,5),60===r&&(r=0),_&&(_.id="",_.classList.remove(o)),u>0&&(u/=5,u--,a[u].id=l,a[u].classList.add(o)),d.textContent=t._numWithZero(r),t._sDialog.sDate.minutes(r)};_.on("pointerUp",h),_.on("dragEnd",h)}},{key:"_attachEventHandlers",value:function(){var t=this,e=this._sDialog.ok,i=this._sDialog.cancel,s=new CustomEvent("onCancel"),a=new CustomEvent("onOk");i.onclick=function(){t.toggle(),t._trigger&&t._trigger.dispatchEvent(s)},e.onclick=function(){t._init=t._sDialog.sDate,t.toggle(),t._trigger&&t._trigger.dispatchEvent(a)}}},{key:"_setButtonText",value:function(){this._sDialog.cancel.textContent=this._cancel,this._sDialog.ok.textContent=this._ok}},{key:"_getMonth",value:function(t,e){var i=void 0;return i=t.clone(),e>0?i.add(Math.abs(e),"M"):i.subtract(Math.abs(e),"M")}},{key:"_nearestDivisor",value:function(t,e){return t%e==0?t:(t-1)%e==0?t-1:(t+1)%e==0?t+1:-1}},{key:"_numWithZero",value:function(t){return t>9?""+t:"0"+t}},{key:"_fillText",value:function(t,e){t.firstChild?t.firstChild.nodeValue=e:t.appendChild(document.createTextNode(e))}},{key:"_addId",value:function(t,e){t.id="mddtp-"+this._type+"__"+e}},{key:"_addClass",value:function(t,e,i){t.classList.add("mddtp-picker__"+e);var s=0;for(i&&(s=i.length,i.reverse());s--;)t.classList.add(i[s])}},{key:"_addView",value:function(t){for(var e=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),a=document.createElement("div"),l=d.default.weekdaysMin(!0).reverse(),n=7;n--;){var o=document.createElement("span");o.textContent=l[n],s.appendChild(o)}this._addClass(e,"month"),this._addClass(i,"grid"),this._addClass(s,"th"),this._addClass(a,"tr"),t.appendChild(e),t.appendChild(i),i.appendChild(s),i.appendChild(a)}},{key:"_calcRotation",value:function(t,e){return 12===t?e*=10:24===t?!0===this._inner24?(e>12&&(e-=12),e*=10):e*=5:e*=2,60===t&&0===e&&(e=120),"mddtp-picker__cell--rotate-"+e}},{key:"time",get:function(){return this._init},set:function(t){t&&(this._init=t)}},{key:"trigger",get:function(){return this._trigger},set:function(t){t&&(this._trigger=t)}}],[{key:"dialog",get:function(){return t._dialog},set:function(e){t._dialog=e}}]),t}();o._dialog={view:!0,state:!1},t.default=o});